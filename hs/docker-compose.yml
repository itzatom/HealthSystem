version: '3'

services:
    postgres:
        build: ./postgres
        container_name: postgres
        ports:
            - 2345:5432
        networks:
            - net
        environment:
            - POSTGRES_USER=postgres
            - POSTGRES_PASSWORD=postgres
    mongo:
        build: ./mongo
        container_name: mongo
        ports:
            - 27017:27017
        environment:
            MONGO_INITDB_ROOT_USERNAME: admin
            MONGO_INITDB_ROOT_PASSWORD: passwd
            MONGO_INITDB_DATABASE: healthsystem 
    flask:
        build: ./flask
        container_name: flask
        volumes:
            - ./flask:/usr/src/app
        ports:
                - 4999:5000
        networks:
            - net
        environment:
            - FLASK_APP=flaskr
            - FLASK_ENV=development
            - FLASK_RUN_HOST=0.0.0.0
        depends_on:
            - mongo
            - postgres
        links:
            - mongo
            - postgres
        command: flask run

networks:
    net:
